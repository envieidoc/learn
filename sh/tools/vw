#!/usr/bin/env bash
#description: display selected images in $viewer
#             browse all other images in the directory as well
#https://wiki.archlinux.org/index.php/Feh#File_Browser_Image_Launcher
#usage: vw file

if [ -f /usr/bin/sxiv ]; then
    viewer=sxiv
elif [ -f /usr/bin/feh ]; then
    viewer=feh
else
    printf "%s\\n" "[-] No viewer available, install sxiv or feh to run this script"
    exit 255
fi

shopt -s nullglob

if [ ! -f "$1" ]; then
    printf "%s\\n" "$(expr "$0" : '.*/\([^/]*\)'): first argument is not a file" >&2
    exit 1
fi

file=$(expr "$1" : '.*/\([^/]*\)')
dir=$(dirname -- "$1")
arr=()
arg=$1
shift

cd -- "$dir"

for i in *; do
    [ -f "$i" ] || continue
    arr+=("$i")
    [ X"$i" = X"$file" ] && c=$(expr ${#arr[@]} - 1)
done

printf "%s\\n" "[+] $viewer $arg"
exec $viewer -f "${arr[@]:c}" "${arr[@]:0:c}"
